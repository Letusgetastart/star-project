{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Player.js"],"names":["cc","Class","extends","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","jumpAudio","default","type","AudioClip","setJumpAction","jumpUp","moveBy","v2","easing","easeCubicActionOut","jumpDown","easeCubicActionIn","callback","callFunc","playJumpSound","repeatForever","sequence","audioEngine","playEffect","onKeyDown","event","keyCode","macro","KEY","left","acceLeft","right","acceRight","a","d","onKeyUp","onLoad","jumpAction","node","runAction","Xspeed","systemEvent","on","SystemEvent","EventType","KEY_DOWN","KEY_UP","onDestroy","off","update","dt","x","width","Math","abs","start"],"mappings":"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","file":"Player.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        //主角跳跃高度\r\n        jumpHeight:0,\r\n        //主角跳跃的持续时间\r\n        jumpDuration:0,\r\n        //最大移动速度\r\n        maxMoveSpeed:0,\r\n        //加速度\r\n        accel:0,\r\n        jumpAudio:{\r\n            default:null,\r\n            type:cc.AudioClip,\r\n        },\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n    setJumpAction:function(){\r\n        //跳跃上升\r\n        var jumpUp=cc.moveBy(this.jumpDuration,cc.v2(0,this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        //下落\r\n        var jumpDown=cc.moveBy(this.jumpDuration,cc.v2(0,-this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n\r\n        var callback=cc.callFunc(this.playJumpSound,this);\r\n        //不断重复\r\n        return cc.repeatForever(cc.sequence(jumpUp,jumpDown,callback));\r\n    },\r\n    playJumpSound(){\r\n        cc.audioEngine.playEffect(this.jumpAudio,false);\r\n    },\r\n\r\n    onKeyDown(event){\r\n        switch(event.keyCode){\r\n            case cc.macro.KEY.left:\r\n                this.acceLeft=true;\r\n                break;\r\n            case cc.macro.KEY.right:\r\n                this.acceRight=true;\r\n                break;\r\n            case cc.macro.KEY.a:\r\n                this.acceLeft=true;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.acceRight=true;\r\n                break;\r\n        }\r\n    },\r\n    \r\n    onKeyUp(event){\r\n        switch(event.keyCode){\r\n            case cc.macro.KEY.a:\r\n                this.acceLeft=false;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.acceRight=false;\r\n                break;\r\n            case cc.macro.KEY.left:\r\n                this.acceLeft=false;\r\n                break;\r\n            case cc.macro.KEY.right:\r\n                this.acceRight=false;\r\n                break;\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        // 初始化跳跃动作\r\n        this.jumpAction = this.setJumpAction();\r\n        this.node.runAction(this.jumpAction);\r\n\r\n        // 加速度方向开关\r\n        this.acceLeft=false;\r\n        this.acceRight=false;\r\n\r\n        // 主角当前水平方向速度\r\n        this.Xspeed=0;\r\n\r\n        // 初始化键盘输入监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n    },\r\n\r\n    onDestroy(){\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n\r\n    },\r\n\r\n    update(dt){\r\n        \r\n         //限制主角不跑出屏幕\r\n         if(this.node.x+this.node.width/2>480){\r\n            this.acceRight=false;\r\n        }\r\n        if(this.node.x-this.node.width/2<-480){\r\n            this.acceLeft=false;\r\n        }\r\n\r\n        // 根据当前加速度方向每帧更新速度\r\n        if(this.acceLeft){\r\n            if(this.Xspeed>0){\r\n                this.Xspeed=0;\r\n            }\r\n            this.Xspeed-=this.accel*dt;\r\n        }\r\n        else if(this.acceRight){\r\n            if(this.Xspeed<0){\r\n                this.Xspeed=0;\r\n            }\r\n            this.Xspeed+=this.accel*dt;\r\n        }else{\r\n            this.Xspeed=0;\r\n        }\r\n\r\n        // 限制主角的速度不能超过最大值\r\n        if(Math.abs(this.Xspeed)>this.maxMoveSpeed){\r\n            this.Xspeed=this.maxMoveSpeed*this.Xspeed/Math.abs(this.Xspeed)\r\n        }\r\n       \r\n\r\n       \r\n\r\n        this.node.x+=this.Xspeed*dt;\r\n        \r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}